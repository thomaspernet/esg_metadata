{"GLOBAL": {"DESCRIPTION": "The relationship between corporate social responsibility (CSR) and corporate financial performance (CFP) has been relentlessly investigated over the last fifty years with diverse conclusions. This paper develops the concept of CSR by meta-analyzing the empirical evidence available on the relationship between CSR and the financial performance of companies. Based on 1476 effects revealed from 111 studies published from 1997 to 2020, we find the probability of observing a positive direct effect to be higher when CSR is measured from the social viewpoint. Furthermore, examining seven categories of CSR while looking deeper into whether the focus is on philanthropy, ESG score, or specialized rating agencies, we find the effect of CSR to be statistically significant only for philanthropy and CSR disclosure categories. While the effect of CSR measured in philanthropy negatively affects CFP, the effect of disclosure on CFP is positive. Overall, our study suggests that the best performances are obtained when CSR is assessed through companies\u2019 own disclosures, and also when firms focus on the social aspects of CSR rather than the environmental aspects. The results based on studies by regions indicate that the best performances are obtained for North American countries where there is a significant positive impact of CSR on CFP. This could suggest that the instrumental stakeholder theory could be supported through the visibility of CSR (from a social point of view) in North America. We have also noted that studies published after the 2009 crisis have a lower probability of finding positive results than those published before the crisis.", "GITHUB": {"owner": "thomaspernet", "repo_name": "esg_metadata"}, "DATABASE": "", "QUERIES_OUTPUT": "SQL_OUTPUT_ATHENA"}, "TABLES": {"CREATION": {"ALL_SCHEMA": [{"description": "SCImago journal database", "schema": [{"Name": "rank", "Type": "bigint", "Comment": "journal rank"}, {"Name": "sourceid", "Type": "bigint", "Comment": "source"}, {"Name": "title", "Type": "string", "Comment": "Journal title"}, {"Name": "type", "Type": "string", "Comment": "Type of journal"}, {"Name": "issn", "Type": "string", "Comment": "ISSN"}, {"Name": "sjr", "Type": "float", "Comment": "SCImago Journal Rank"}, {"Name": "sjr_best_quartile", "Type": "string", "Comment": "SCImago Journal Rank rank by quartile"}, {"Name": "h_index", "Type": "float", "Comment": "h-index is an author-level metric that measures both the productivity and citation impact of the publications of a scientist or scholar"}, {"Name": "total_docs", "Type": "float", "Comment": "total doc in 2020"}, {"Name": "total_docs_3years", "Type": "float", "Comment": "total doc past 3 years"}, {"Name": "total_refs", "Type": "float", "Comment": "total references"}, {"Name": "total_cites_3years", "Type": "float", "Comment": "total cited last 3 years"}, {"Name": "citable_docs_3years", "Type": "float", "Comment": "citable doc"}, {"Name": "cites_doc_2years", "Type": "float", "Comment": "citation per doc over the last 3 years"}, {"Name": "ref_doc", "Type": "float", "Comment": "number of reference per doc"}, {"Name": "country", "Type": "string", "Comment": "country of origin"}, {"Name": "region", "Type": "string", "Comment": "region of origin"}, {"Name": "publisher", "Type": "string", "Comment": "publisher"}, {"Name": "coverage", "Type": "string", "Comment": "coverage"}, {"Name": "categories", "Type": "string", "Comment": "categories"}], "partition_keys": [], "metadata": {"DatabaseName": "scimago", "TablePrefix": "journals_", "TableName": "journals_scimago", "target_S3URI": "s3://datalake-london/DATA/JOURNALS/SCIMAGO", "from_athena": "False", "filename": "scimagojr.py", "github_url": "https://github.com/thomaspernet/esg_metadata/01_data_preprocessing/00_download_data/SCIMAGO/scimagojr.py"}}, {"description": "upload new values for papers in Drive", "schema": [{"Name": "id", "Type": "string", "Comment": "paper ID"}, {"Name": "incremental_id", "Type": "string", "Comment": "row id"}, {"Name": "paper_name", "Type": "string", "Comment": "Paper name"}, {"Name": "dependent", "Type": "string", "Comment": "dependent variable"}, {"Name": "independent", "Type": "string", "Comment": "independent variables"}, {"Name": "lag", "Type": "string", "Comment": "the table contains lag or not"}, {"Name": "interaction_term", "Type": "string", "Comment": "the table contains interaction terms or not"}, {"Name": "quadratic_term", "Type": "string", "Comment": "the table contains quadratic terms or not"}, {"Name": "n", "Type": "float", "Comment": "number of observations"}, {"Name": "r2", "Type": "float", "Comment": "R square"}, {"Name": "beta", "Type": "float", "Comment": "Beta coefficient"}, {"Name": "sign", "Type": "string", "Comment": "sign positive or negative"}, {"Name": "star", "Type": "string", "Comment": "Level of significant. *, ** or ***"}, {"Name": "sr", "Type": "float", "Comment": "standard error"}, {"Name": "p_value", "Type": "float", "Comment": "p value"}, {"Name": "t_value", "Type": "float", "Comment": "student value"}, {"Name": "image", "Type": "string", "Comment": "Link row data image"}, {"Name": "table_refer", "Type": "string", "Comment": "table number in the paper"}, {"Name": "model_name", "Type": "string", "Comment": "Model name from Susie"}, {"Name": "updated_model_name", "Type": "string", "Comment": "Model name adjusted by Thomas"}, {"Name": "adjusted_model_name", "Type": "string", "Comment": "Model name normalised"}, {"Name": "doi", "Type": "string", "Comment": "DOI"}, {"Name": "drive_url", "Type": "string", "Comment": "paper link in Google Drive"}, {"Name": "test_standard_error", "Type": "string", "Comment": "check if sr really standard error by comparing beta divided by sr and critical values"}, {"Name": "test_p_value", "Type": "string", "Comment": "check if sign and p value match"}, {"Name": "test_t_value", "Type": "string", "Comment": "check if t critial value and sign match"}, {"Name": "should_t_value", "Type": "string", "Comment": "use sr as t value when mistake"}, {"Name": "adjusted_standard_error", "Type": "float", "Comment": "reconstructed standard error"}, {"Name": "final_standard_error", "Type": "float", "Comment": "reconstructed standard error and use sr when true_standard_error is nan or error"}, {"Name": "adjusted_t_value", "Type": "float", "Comment": "reconstructed t value"}, {"Name": "true_stars", "Type": "string", "Comment": "reconstructed stars"}, {"Name": "adjusted_dependent", "Type": "string", "Comment": "reorganise dependent variable into smaller groups"}, {"Name": "adjusted_independent", "Type": "string", "Comment": "reorganise independent variable into smaller group"}, {"Name": "adjusted_model", "Type": "string", "Comment": "reorganise model variable into smaller group"}, {"Name": "p_value_significant", "Type": "string", "Comment": "is beta significant. Computed from reconstructed critical values, not the paper. From paper, see variable target"}, {"Name": "to_check_final", "Type": "string", "Comment": "Final check rows"}, {"Name": "critical_99", "Type": "string", "Comment": "99 t stat critical value calculated based on nb obserations"}, {"Name": "critical_90", "Type": "string", "Comment": "90 t stat critical value calculated based on nb obserations"}, {"Name": "critical_95", "Type": "string", "Comment": "95 t stat critical value calculated based on nb obserations"}, {"Name": "social", "Type": "string", "Comment": "if adjusted_independent in ENVIRONMENTAL AND SOCIAL, SOCIAL, CSP, CSR, ENVIRONMENTAL, SOCIAL and GOVERNANCE"}, {"Name": "environmental", "Type": "string", "Comment": "if adjusted_independent in ENVIRONMENTAL, ENVIRONMENTAL AND SOCIAL, ENVIRONMENTAL, SOCIAL and GOVERNANCE"}, {"Name": "governance", "Type": "string", "Comment": "if adjusted_independent in GOVERNANCE ENVIRONMENTAL, SOCIAL and GOVERNANCE"}, {"Name": "sign_of_effect", "Type": "string", "Comment": "if stars is not blank and beta > 0, then POSITIVE, if stars is not blank and beta < 0, then NEGATIVE else INSIGNIFICANT"}, {"Name": "row_id_google_spreadsheet", "Type": "string", "Comment": "Google spreadsheet link to raw data"}, {"Name": "sign_positive", "Type": "string", "Comment": "if sign_of_effect is POSITIVE then True"}, {"Name": "sign_negative", "Type": "string", "Comment": "if sign_of_effect is NEGATIVE then True"}, {"Name": "sign_significant", "Type": "string", "Comment": "if sign_of_effect is INSIGNIFICANT then False else True"}, {"Name": "model_instrument", "Type": "string", "Comment": "if adjusted_model is equal to INSTRUMENT then true"}, {"Name": "model_diff_in_diff", "Type": "string", "Comment": "if adjusted_model is equal to DIFF IN DIFF then true"}, {"Name": "model_other", "Type": "string", "Comment": "if adjusted_model is equal to OTHER then true"}, {"Name": "model_fixed_effect", "Type": "string", "Comment": "if adjusted_model is equal to FIXED EFFECT then true"}, {"Name": "model_lag_dependent", "Type": "string", "Comment": "if adjusted_model is equal to LAG DEPENDENT then true"}, {"Name": "model_pooled_ols", "Type": "string", "Comment": "if adjusted_model is equal to POOLED OLS then true"}, {"Name": "model_random_effect", "Type": "string", "Comment": "if adjusted_model is equal to RANDOM EFFECT then true"}, {"Name": "target", "Type": "string", "Comment": "indicate wheither or not the coefficient is significant. based on stars"}], "partition_keys": [], "metadata": {"DatabaseName": "esg", "TablePrefix": "papers_", "TableName": "papers_meta_analysis_new", "target_S3URI": "s3://datalake-london/DATA/FINANCE/ESG/META_ANALYSIS_NEW", "from_athena": "False", "filename": "esg_metaanalysis.py", "github_url": "https://github.com/thomaspernet/esg_metadata/01_data_preprocessing/00_download_data/METADATA_TABLES/esg_metaanalysis.py"}}]}, "PREPARATION": {"STEPS": []}, "TRANSFORMATION": {"STEPS": [{"description": "\nCreate table with journal information, papers and coefficients for the meta analysis\n", "query": "\nSELECT \n      rank, \n      regexp_replace(\n        regexp_replace(\n          lower(title), \n          '\\&', \n          'and'\n        ), \n        '\\-', \n        ' '\n      ) as publication, \n      sjr,\n      region as region_journal\n    FROM \n      \"scimago\".\"journals_scimago\"\n    WHERE sourceid not in (16400154787)\n", "schema": [{"Name": "paperid", "Type": "string", "Comment": "paperid"}, {"Name": "nb_authors", "Type": "int", "Comment": "nb authors"}, {"Name": "reference_count", "Type": "int", "Comment": "reference count"}, {"Name": "citation_count", "Type": "int", "Comment": "citation count"}, {"Name": "influential_citation_count", "Type": "int", "Comment": "influential citation count"}, {"Name": "is_open_access", "Type": "boolean", "Comment": "is open access"}, {"Name": "total_paper", "Type": "int", "Comment": "total paper"}, {"Name": "esg", "Type": "int", "Comment": "esg"}, {"Name": "pct_esg", "Type": "float", "Comment": "pct esg"}, {"Name": "id_source", "Type": "string", "Comment": "id source"}, {"Name": "female", "Type": "int", "Comment": "female"}, {"Name": "male", "Type": "int", "Comment": "male"}, {"Name": "unknown", "Type": "int", "Comment": "unknown"}, {"Name": "pct_female", "Type": "float", "Comment": "pct female"}, {"Name": "drive_url", "Type": "string", "Comment": "drive url"}, {"Name": "image", "Type": "string", "Comment": "image"}, {"Name": "row_id_google_spreadsheet", "Type": "string", "Comment": "row id google spreadsheet"}, {"Name": "table_refer", "Type": "string", "Comment": "table refer"}, {"Name": "adjusted_model", "Type": "string", "Comment": "adjusted model"}, {"Name": "adjusted_dependent", "Type": "string", "Comment": "adjusted dependent"}, {"Name": "adjusted_independent", "Type": "string", "Comment": "adjusted independent"}, {"Name": "social", "Type": "string", "Comment": "social"}, {"Name": "environmental", "Type": "string", "Comment": "environmental"}, {"Name": "governance", "Type": "string", "Comment": "governance"}, {"Name": "lag", "Type": "string", "Comment": "lag"}, {"Name": "interaction_term", "Type": "string", "Comment": "interaction term"}, {"Name": "quadratic_term", "Type": "string", "Comment": "quadratic term"}, {"Name": "n", "Type": "int", "Comment": "n"}, {"Name": "target", "Type": "string", "Comment": "target"}, {"Name": "adjusted_standard_error", "Type": "float", "Comment": "adjusted standard error"}, {"Name": "adjusted_t_value", "Type": "float", "Comment": "adjusted t value"}, {"Name": "paper_name", "Type": "string", "Comment": "paper name"}, {"Name": "first_date_of_observations", "Type": "int", "Comment": "first date of observations"}, {"Name": "last_date_of_observations", "Type": "int", "Comment": "last date of observations"}, {"Name": "csr_20_categories", "Type": "string", "Comment": "csr 20 categories"}, {"Name": "regions_of_selected_firms", "Type": "string", "Comment": "regions of selected firms"}, {"Name": "kyoto", "Type": "string", "Comment": "kyoto"}, {"Name": "financial_crisis", "Type": "string", "Comment": "financial crisis"}, {"Name": "windows", "Type": "int", "Comment": "windows"}, {"Name": "mid_year", "Type": "int", "Comment": "mid year"}, {"Name": "regions", "Type": "string", "Comment": "regions"}, {"Name": "providers", "Type": "string", "Comment": "providers"}, {"Name": "publication_year", "Type": "int", "Comment": "publication year"}, {"Name": "publication_name", "Type": "string", "Comment": "publication name"}, {"Name": "rank_digit", "Type": "string", "Comment": "rank digit"}, {"Name": "cluster_w_emb", "Type": "int", "Comment": "cluster w emb"}, {"Name": "sentiment", "Type": "string", "Comment": "sentiment"}, {"Name": "lenght", "Type": "int", "Comment": "lenght"}, {"Name": "adj", "Type": "int", "Comment": "adj"}, {"Name": "noun", "Type": "int", "Comment": "noun"}, {"Name": "verb", "Type": "int", "Comment": "verb"}, {"Name": "size_abstract", "Type": "int", "Comment": "size abstract"}, {"Name": "pct_adj", "Type": "float", "Comment": "pct adj"}, {"Name": "pct_noun", "Type": "float", "Comment": "pct noun"}, {"Name": "pct_verb", "Type": "float", "Comment": "pct verb"}, {"Name": "rank", "Type": "int", "Comment": "journal rank"}, {"Name": "sjr", "Type": "float", "Comment": "SCImago Journal Rank"}, {"Name": "region_journal", "Type": "string", "Comment": "region journal"}], "partition_keys": ["id", "incremental_id"], "metadata": {"DatabaseName": "esg", "TableName": "meta_analysis_esg_cfp", "input": ["journals_scimago"], "target_S3URI": "s3://datalake-london/DATA/FINANCE/ESG/ESG_CFP", "from_athena": "True", "filename": "00_meta_analysis.ipynb", "index_final_table": [0], "if_final": "True", "github_url": "https://github.com/thomaspernet/esg_metadata/blob/master/01_data_preprocessing/01_transform_tables/00_meta_analysis.md"}}]}}, "ANALYSIS": {"COUNT_MISSING": {"top": "SELECT COUNT(*) as nb_obs, ", "middle": "COUNT(*) - COUNT({0}) AS {0}", "bottom": " FROM {}.{}"}, "CATEGORICAL": {"PAIR": "SELECT {2}, COUNT(*) AS nb_obs FROM {0}.{1} GROUP BY {2} ORDER BY nb_obs DESC ", "MULTI_PAIR": "SELECT {2}, {3}, COUNT(*) AS nb_obs FROM {0}.{1} GROUP BY {2}, {3} ORDER BY nb_obs DESC "}, "CONTINUOUS": {"DISTRIBUTION": {"top_1": "SELECT * FROM (WITH table_wrapper AS (", "top_2": ") SELECT table_wrapper.pct,", "top_3": " FROM table_wrapper ", "middle_1": "  LEFT JOIN ( ", "middle_2": " ) as table_2_{0} ON table_wrapper.pct = table_2_{0}.pct ", "bottom": "WITH table_{3} AS ( SELECT MAP( ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {2}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} ) SELECT pct, value AS {2} FROM table_{3} CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "ONE_PAIR_DISTRIBUTION": {"top_1": "SELECT * FROM (WITH table_wrapper AS (", "top_2": ") SELECT table_wrapper.pct, table_wrapper.{}, ", "top_3": " FROM table_wrapper ", "middle_1": "  LEFT JOIN ( ", "middle_2": " ) as table_2_{0} ON table_wrapper.{1} = table_2_{0}.{1} AND table_wrapper.pct = table_2_{0}.pct ", "bottom": "WITH table_{3} AS ( SELECT {4}, MAP(ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {2}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} GROUP BY {4}) SELECT {4}, pct, value AS {2} FROM table_{3} CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "TWO_PAIRS_DISTRIBUTION": "WITH dataset AS ( SELECT {2}, {3}, MAP( ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {4}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} GROUP BY {2}, {3} ) SELECT {2}, {3}, pct, value AS {4} FROM dataset CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "COUNT_DUPLICATES": {"query": "SELECT CNT, COUNT(*) AS CNT_DUPLICATE FROM ( SELECT {2}, COUNT(*) as CNT FROM {0}.{1} GROUP BY {2} ) GROUP BY CNT ORDER BY CNT_DUPLICATE"}}}