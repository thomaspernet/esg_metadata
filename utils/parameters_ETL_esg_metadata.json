{"GLOBAL": {"DESCRIPTION": "The relationship between corporate social responsibility (CSR) and corporate financial performance (CFP) has been relentlessly investigated over the last fifty years with diverse conclusions. This paper develops the concept of CSR by meta-analyzing the empirical evidence available on the relationship between CSR and the financial performance of companies. Based on 1476 effects revealed from 111 studies published from 1997 to 2020, we find the probability of observing a positive direct effect to be higher when CSR is measured from the social viewpoint. Furthermore, examining seven categories of CSR while looking deeper into whether the focus is on philanthropy, ESG score, or specialized rating agencies, we find the effect of CSR to be statistically significant only for philanthropy and CSR disclosure categories. While the effect of CSR measured in philanthropy negatively affects CFP, the effect of disclosure on CFP is positive. Overall, our study suggests that the best performances are obtained when CSR is assessed through companies\u2019 own disclosures, and also when firms focus on the social aspects of CSR rather than the environmental aspects. The results based on studies by regions indicate that the best performances are obtained for North American countries where there is a significant positive impact of CSR on CFP. This could suggest that the instrumental stakeholder theory could be supported through the visibility of CSR (from a social point of view) in North America. We have also noted that studies published after the 2009 crisis have a lower probability of finding positive results than those published before the crisis.", "GITHUB": {"owner": "thomaspernet", "repo_name": "esg_metadata"}, "DATABASE": "", "QUERIES_OUTPUT": "SQL_OUTPUT_ATHENA"}, "TABLES": {"CREATION": {"ALL_SCHEMA": [{"description": "SCImago journal database", "schema": [{"Name": "rank", "Type": "bigint", "Comment": "journal rank"}, {"Name": "sourceid", "Type": "bigint", "Comment": "source"}, {"Name": "title", "Type": "string", "Comment": "Journal title"}, {"Name": "type", "Type": "string", "Comment": "Type of journal"}, {"Name": "issn", "Type": "string", "Comment": "ISSN"}, {"Name": "sjr", "Type": "float", "Comment": "SCImago Journal Rank"}, {"Name": "sjr_best_quartile", "Type": "string", "Comment": "SCImago Journal Rank rank by quartile"}, {"Name": "h_index", "Type": "float", "Comment": "h-index is an author-level metric that measures both the productivity and citation impact of the publications of a scientist or scholar"}, {"Name": "total_docs", "Type": "float", "Comment": "total doc in 2020"}, {"Name": "total_docs_3years", "Type": "float", "Comment": "total doc past 3 years"}, {"Name": "total_refs", "Type": "float", "Comment": "total references"}, {"Name": "total_cites_3years", "Type": "float", "Comment": "total cited last 3 years"}, {"Name": "citable_docs_3years", "Type": "float", "Comment": "citable doc"}, {"Name": "cites_doc_2years", "Type": "float", "Comment": "citation per doc over the last 3 years"}, {"Name": "ref_doc", "Type": "float", "Comment": "number of reference per doc"}, {"Name": "country", "Type": "string", "Comment": "country of origin"}, {"Name": "region", "Type": "string", "Comment": "region of origin"}, {"Name": "publisher", "Type": "string", "Comment": "publisher"}, {"Name": "coverage", "Type": "string", "Comment": "coverage"}, {"Name": "categories", "Type": "string", "Comment": "categories"}], "partition_keys": [], "metadata": {"DatabaseName": "scimago", "TablePrefix": "journals_", "TableName": "journals_scimago", "target_S3URI": "s3://datalake-london/DATA/JOURNALS/SCIMAGO", "from_athena": "False", "filename": "scimagojr.py", "github_url": "https://github.com/thomaspernet/esg_metadata/01_data_preprocessing/00_download_data/SCIMAGO/scimagojr.py"}}, {"description": "upload new values for papers in Drive", "schema": [{"Name": "id", "Type": "string", "Comment": "paper ID"}, {"Name": "incremental_id", "Type": "string", "Comment": "row id"}, {"Name": "paper_name", "Type": "string", "Comment": "Paper name"}, {"Name": "dependent", "Type": "string", "Comment": "dependent variable"}, {"Name": "independent", "Type": "string", "Comment": "independent variables"}, {"Name": "lag", "Type": "string", "Comment": "the table contains lag or not"}, {"Name": "interaction_term", "Type": "string", "Comment": "the table contains interaction terms or not"}, {"Name": "quadratic_term", "Type": "string", "Comment": "the table contains quadratic terms or not"}, {"Name": "n", "Type": "float", "Comment": "number of observations"}, {"Name": "r2", "Type": "float", "Comment": "R square"}, {"Name": "beta", "Type": "float", "Comment": "Beta coefficient"}, {"Name": "sign", "Type": "string", "Comment": "sign positive or negative"}, {"Name": "star", "Type": "string", "Comment": "Level of significant. *, ** or ***"}, {"Name": "sr", "Type": "float", "Comment": "standard error"}, {"Name": "p_value", "Type": "float", "Comment": "p value"}, {"Name": "t_value", "Type": "float", "Comment": "student value"}, {"Name": "image", "Type": "string", "Comment": "Link row data image"}, {"Name": "table_refer", "Type": "string", "Comment": "table number in the paper"}, {"Name": "model_name", "Type": "string", "Comment": "Model name from Susie"}, {"Name": "updated_model_name", "Type": "string", "Comment": "Model name adjusted by Thomas"}, {"Name": "adjusted_model_name", "Type": "string", "Comment": "Model name normalised"}, {"Name": "doi", "Type": "string", "Comment": "DOI"}, {"Name": "drive_url", "Type": "string", "Comment": "paper link in Google Drive"}, {"Name": "test_standard_error", "Type": "string", "Comment": "check if sr really standard error by comparing beta divided by sr and critical values"}, {"Name": "test_p_value", "Type": "string", "Comment": "check if sign and p value match"}, {"Name": "test_t_value", "Type": "string", "Comment": "check if t critial value and sign match"}, {"Name": "should_t_value", "Type": "string", "Comment": "use sr as t value when mistake"}, {"Name": "true_standard_error", "Type": "float", "Comment": "reconstructed standard error"}, {"Name": "true_t_value", "Type": "float", "Comment": "reconstructed t value"}, {"Name": "true_stars", "Type": "string", "Comment": "reconstructed stars"}, {"Name": "adjusted_dependent", "Type": "string", "Comment": "reorganise dependent variable into smaller groups"}, {"Name": "adjusted_independent", "Type": "float", "Comment": "reorganise independent variable into smaller group"}, {"Name": "adjusted_model", "Type": "string", "Comment": "reorganise model variable into smaller group"}, {"Name": "significant", "Type": "string", "Comment": "is beta significant"}, {"Name": "to_check_final", "Type": "string", "Comment": "Final check rows"}, {"Name": "critical_99", "Type": "string", "Comment": "99 t stat critical value calculated based on nb obserations"}, {"Name": "critical_90", "Type": "string", "Comment": "90 t stat critical value calculated based on nb obserations"}, {"Name": "critical_95", "Type": "string", "Comment": "95 t stat critical value calculated based on nb obserations"}], "partition_keys": [], "metadata": {"DatabaseName": "esg", "TablePrefix": "papers_", "TableName": "papers_meta_analysis_new", "target_S3URI": "s3://datalake-london/DATA/FINANCE/ESG/META_ANALYSIS_NEW", "from_athena": "False", "filename": "esg_metaanalysis.py", "github_url": "https://github.com/thomaspernet/esg_metadata/01_data_preprocessing/00_download_data/METADATA_TABLES/esg_metaanalysis.py"}}]}, "PREPARATION": {"STEPS": []}, "TRANSFORMATION": {"STEPS": [{"description": "\nCreate table with journal information, papers and coefficients for the meta analysis\n", "query": "\nCREATE TABLE esg.meta_analysis_esg_cfp WITH (format = 'PARQUET') AS\nWITH merge AS (\n  SELECT \n    id, \n    image,\n    table_refer,\n    incremental_id,\n    paper_name, \n    publication_year, \n    publication_type, \n    regexp_replace(\n      regexp_replace(\n        lower(publication_name), \n        '\\&', \n        'and'\n      ), \n      '\\-', \n      ' '\n    ) as publication_name, \n    cnrs_ranking, \n    -- ranking, \n    peer_reviewed, \n    study_focused_on_social_environmental_behaviour, \n    type_of_data, \n    study_focusing_on_developing_or_developed_countries, \n    first_date_of_observations,\n    last_date_of_observations,\n    dependent, \n    independent, \n    lag, \n    interaction_term, \n    quadratic_term, \n    n, \n    r2, \n    beta, \n    to_remove, \n    critical_value, \n    true_standard_error, \n    true_t_value, \n    true_stars, \n    adjusted_dependent, \n    adjusted_independent, \n    adjusted_model, \n    significant,\n    to_check_final\n  FROM \n    esg.papers_meta_analysis_new \n    LEFT JOIN (\n      SELECT \n        DISTINCT(title), \n        nr, \n        publication_year, \n        publication_type, \n        publication_name, \n        cnrs_ranking, \n        peer_reviewed, \n        study_focused_on_social_environmental_behaviour, \n        type_of_data, \n        study_focusing_on_developing_or_developed_countries\n      FROM \n        esg.papers_meta_analysis\n    ) as old on papers_meta_analysis_new.id = old.nr\n    -- WHERE to_remove = 'TO_KEEP'\nLEFT JOIN (\nSELECT \n        nr,\n        CAST(MIN(first_date_of_observations) as int) as first_date_of_observations,\n        CAST(MAX(last_date_of_observations)as int) as last_date_of_observations\n      FROM \n        esg.papers_meta_analysis\n        GROUP BY nr\n) as date_pub on papers_meta_analysis_new.id = date_pub.nr\n) \nSELECT \n  id, \n    image,\n    table_refer,\n    incremental_id,\n    paper_name,\n    publication_name,\n    rank,\n    sjr, \n    sjr_best_quartile, \n    h_index, \n    total_docs_2020, \n    total_docs_3years, \n    total_refs, \n    total_cites_3years, \n    citable_docs_3years, \n    cites_doc_2years, \n    country ,\n    publication_year, \n    publication_type, \n    cnrs_ranking, \n    peer_reviewed, \n    study_focused_on_social_environmental_behaviour, \n    type_of_data, \n    study_focusing_on_developing_or_developed_countries, \n    first_date_of_observations,\n    last_date_of_observations,\n    dependent, \n    independent, \n    lag, \n    interaction_term, \n    quadratic_term, \n    n, \n    r2, \n    beta, \n    to_remove, \n    critical_value, \n    true_standard_error, \n    true_t_value, \n    true_stars, \n    adjusted_dependent, \n    adjusted_independent, \n    adjusted_model, \n    significant,\n    to_check_final  \nFROM \n  merge \n  LEFT JOIN (\n    SELECT \n      rank, \n      regexp_replace(\n        regexp_replace(\n          lower(title), \n          '\\&', \n          'and'\n        ), \n        '\\-', \n        ' '\n      ) as title, \n      sjr, \n      sjr_best_quartile, \n      h_index, \n      total_docs_2020, \n      total_docs_3years, \n      total_refs, \n      total_cites_3years, \n      citable_docs_3years, \n      cites_doc_2years, \n      country \n    FROM \n      \"scimago\".\"journals_scimago\"\n    WHERE sourceid not in (16400154787)\n  ) as journal on merge.publication_name = journal.title\n", "schema": [{"Name": "id", "Type": "string", "Comment": "paper ID"}, {"Name": "image", "Type": "string", "Comment": "Link row data image"}, {"Name": "table_refer", "Type": "string", "Comment": "table number in the paper"}, {"Name": "incremental_id", "Type": "string", "Comment": "row id"}, {"Name": "paper_name", "Type": "string", "Comment": "Paper name"}, {"Name": "publication_name", "Type": "string", "Comment": "publication name"}, {"Name": "rank", "Type": "bigint", "Comment": "journal rank"}, {"Name": "sjr", "Type": "float", "Comment": "SCImago Journal Rank"}, {"Name": "sjr_best_quartile", "Type": "string", "Comment": "SCImago Journal Rank rank by quartile"}, {"Name": "h_index", "Type": "float", "Comment": "h-index is an author-level metric that measures both the productivity and citation impact of the publications of a scientist or scholar"}, {"Name": "total_docs_2020", "Type": "bigint", "Comment": "total docs 2020"}, {"Name": "total_docs_3years", "Type": "float", "Comment": "total doc past 3 years"}, {"Name": "total_refs", "Type": "float", "Comment": "total references"}, {"Name": "total_cites_3years", "Type": "float", "Comment": "total cited last 3 years"}, {"Name": "citable_docs_3years", "Type": "float", "Comment": "citable doc"}, {"Name": "cites_doc_2years", "Type": "float", "Comment": "citation per doc over the last 3 years"}, {"Name": "country", "Type": "string", "Comment": "country of origin"}, {"Name": "publication_year", "Type": "float", "Comment": "publication year"}, {"Name": "publication_type", "Type": "string", "Comment": "publication type"}, {"Name": "cnrs_ranking", "Type": "string", "Comment": "cnrs ranking"}, {"Name": "peer_reviewed", "Type": "string", "Comment": "peer reviewed"}, {"Name": "study_focused_on_social_environmental_behaviour", "Type": "string", "Comment": "study focused on social environmental behaviour"}, {"Name": "type_of_data", "Type": "string", "Comment": "type of data"}, {"Name": "study_focusing_on_developing_or_developed_countries", "Type": "string", "Comment": "study focusing on developing or developed countries"}, {"Name": "first_date_of_observations", "Type": "int", "Comment": "first date of observations"}, {"Name": "last_date_of_observations", "Type": "int", "Comment": "last date of observations"}, {"Name": "dependent", "Type": "string", "Comment": "dependent variable"}, {"Name": "independent", "Type": "string", "Comment": "independent variables"}, {"Name": "lag", "Type": "string", "Comment": "the table contains lag or not"}, {"Name": "interaction_term", "Type": "string", "Comment": "the table contains interaction terms or not"}, {"Name": "quadratic_term", "Type": "string", "Comment": "the table contains quadratic terms or not"}, {"Name": "n", "Type": "float", "Comment": "number of observations"}, {"Name": "r2", "Type": "float", "Comment": "R square"}, {"Name": "beta", "Type": "float", "Comment": "Beta coefficient"}, {"Name": "to_remove", "Type": "string", "Comment": "to remove"}, {"Name": "critical_value", "Type": "double", "Comment": "critical value"}, {"Name": "true_standard_error", "Type": "float", "Comment": "reconstructed standard error"}, {"Name": "true_t_value", "Type": "float", "Comment": "reconstructed t value"}, {"Name": "true_stars", "Type": "string", "Comment": "reconstructed stars"}, {"Name": "adjusted_dependent", "Type": "string", "Comment": "reorganise dependent variable into smaller groups"}, {"Name": "adjusted_independent", "Type": "float", "Comment": "reorganise independent variable into smaller group"}, {"Name": "adjusted_model", "Type": "string", "Comment": "reorganise model variable into smaller group"}, {"Name": "significant", "Type": "string", "Comment": "is beta significant"}, {"Name": "to_check_final", "Type": "string", "Comment": "Final check rows"}], "partition_keys": ["id", "incremental_id"], "metadata": {"DatabaseName": "esg", "TableName": "meta_analysis_esg_cfp", "input": ["papers_meta_analysis_new", "papers_meta_analysis", "journals_scimago"], "target_S3URI": "s3://datalake-london/DATA/FINANCE/ESG/ESG_CFP", "from_athena": "True", "filename": "00_meta_analysis.ipynb", "index_final_table": [0], "if_final": "True", "github_url": "https://github.com/thomaspernet/esg_metadata/blob/master/01_data_preprocessing/01_transform_tables/00_meta_analysis.md"}}]}}, "ANALYSIS": {"COUNT_MISSING": {"top": "SELECT COUNT(*) as nb_obs, ", "middle": "COUNT(*) - COUNT({0}) AS {0}", "bottom": " FROM {}.{}"}, "CATEGORICAL": {"PAIR": "SELECT {2}, COUNT(*) AS nb_obs FROM {0}.{1} GROUP BY {2} ORDER BY nb_obs DESC ", "MULTI_PAIR": "SELECT {2}, {3}, COUNT(*) AS nb_obs FROM {0}.{1} GROUP BY {2}, {3} ORDER BY nb_obs DESC "}, "CONTINUOUS": {"DISTRIBUTION": {"top_1": "SELECT * FROM (WITH table_wrapper AS (", "top_2": ") SELECT table_wrapper.pct,", "top_3": " FROM table_wrapper ", "middle_1": "  LEFT JOIN ( ", "middle_2": " ) as table_2_{0} ON table_wrapper.pct = table_2_{0}.pct ", "bottom": "WITH table_{3} AS ( SELECT MAP( ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {2}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} ) SELECT pct, value AS {2} FROM table_{3} CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "ONE_PAIR_DISTRIBUTION": {"top_1": "SELECT * FROM (WITH table_wrapper AS (", "top_2": ") SELECT table_wrapper.pct, table_wrapper.{}, ", "top_3": " FROM table_wrapper ", "middle_1": "  LEFT JOIN ( ", "middle_2": " ) as table_2_{0} ON table_wrapper.{1} = table_2_{0}.{1} AND table_wrapper.pct = table_2_{0}.pct ", "bottom": "WITH table_{3} AS ( SELECT {4}, MAP(ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {2}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} GROUP BY {4}) SELECT {4}, pct, value AS {2} FROM table_{3} CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "TWO_PAIRS_DISTRIBUTION": "WITH dataset AS ( SELECT {2}, {3}, MAP( ARRAY[0.25, 0.50, 0.75, 0.95, 0.99], approx_percentile( {4}, ARRAY[0.25, 0.50, 0.75, 0.95, 0.99] ) ) as nest FROM {0}.{1} GROUP BY {2}, {3} ) SELECT {2}, {3}, pct, value AS {4} FROM dataset CROSS JOIN UNNEST(nest) AS t(pct, value)"}, "COUNT_DUPLICATES": {"query": "SELECT CNT, COUNT(*) AS CNT_DUPLICATE FROM ( SELECT {2}, COUNT(*) as CNT FROM {0}.{1} GROUP BY {2} ) GROUP BY CNT ORDER BY CNT_DUPLICATE"}}}